# ATM Cash Demand Forecasting Pipeline (2 задание Актионада 2025)

## Описание

Пайплайн для прогнозирования суточного спроса на наличные в банкоматах на 14 дней вперед. Использует временные ряды и машинное обучение для оптимизации управления ликвидностью.

## Входной формат данных

### Обязательные столбцы в CSV файле:

| Столбец | Тип | Описание |
|---------|-----|-----------|
| `ATM_ID` | string | Уникальный идентификатор банкомата |
| `Date` | string | Дата в формате YYYY-MM-DD |
| `Total_Withdrawals` | int | Сумма снятий за период |
| `Total_Deposits` | int | Сумма депозитов за период |
| `Location_Type` | string | Тип расположения (Mall, Bank, Airport, etc.) |
| `Holiday_Flag` | int | Флаг праздника (0/1) |
| `Weather_Condition` | string | Погодные условия (Clear, Rainy, Cloudy, etc.) |
| `Cash_Demand_Next_Day` | int | Целевая переменная - спрос на следующий день |

## Шаги для запуска

### 1. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 2. Подготовка данных
```python
import pandas as pd
from lightgbm import LGBMRegressor

# Загрузка данных
df = pd.read_csv('atm_cash_management_dataset.csv')
```

### 3. Запуск пайплайна
```python
from pipeline.py import ATMCashForecastPipeline

# Инициализация пайплайна
model = LGBMRegressor(n_estimators=100, random_state=42)
pipeline = ATMCashForecastPipeline(model=model, lags=7)

# Валидация и обучение
pipeline.validate_input_data(df)
pipeline.train(df)

# Прогноз на 14 дней
forecast = pipeline.predict_14_days(df)
print("Прогноз на 14 дней:")
print(forecast)
```

## Формат выходных данных

Прогноз возвращается в формате DataFrame:

```
           Day_1  Day_2  Day_3  ...  Day_14
ATM_001    45000  44500  45200  ...   44800
ATM_002    38000  37500  38200  ...   37800
ATM_003    52000  51500  52200  ...   51800
```

**Структура:**
- **Строки**: ID банкоматов (`ATM_001`, `ATM_002`, etc.)
- **Столбцы**: Дни прогноза (`Day_1` - `Day_14`)
- **Значения**: Прогнозируемый спрос на наличные (целые числа)

## Интерпретация результатов

### Пример вывода:
```
           Day_1  Day_2  Day_3  Day_4
ATM_001   57051  57234  56892  57123
ATM_002   56655  56478  56789  56543
ATM_003   61318  61542  61087  61256
```

### Как интерпретировать:
- **ATM_001**: Ожидаемый спрос ~57,000 единиц в первые дни
- **ATM_003**: Самый высокий спрос (~61,000), вероятно из-за расположения
- **Стабильность**: Небольшие колебания между днями указывают на устойчивые паттерны

### Практическое применение:
1. **Планирование инкассации**: ATM_003 требует больше наличных
2. **Оптимизация маршрутов**: Приоритет банкоматам с высоким спросом
3. **Управление рисками**: Выявление аномалий и сезонных паттернов
